<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Movvify ‚Äî YouTube Downloader</title>
    <link rel="stylesheet" href="/css/style.css" />
</head>

<body>
    <main class="container">
        <h1 class="brand small">Movvify</h1>
        <h2>üé• YouTube Downloader</h2>


        <form class="panel" action="/download" method="POST" target="_blank">
            <label for="urlInput">Paste YouTube link</label>
            <input type="url" id="urlInput" name="url" placeholder="https://youtu.be/..." required />


            <div id="thumbnailPreview" class="thumbnail-box"></div>

            <label>Choose quality</label>
            <select name="quality" required>
                <option value="144">144p (Low)</option>
                <option value="240">240p</option>
                <option value="360">360p (SD)</option>
                <option value="480">480p (HQ)</option>
                <option value="720">720p (HD)</option>
                <option value="1080" selected>1080p (Full HD)</option>
                <option value="1440">1440p (2K)</option>
                <option value="2160">2160p (4K)</option>
                <option value="best">Best Available</option>
            </select>

            <button type="submit">Download üé¨</button>
            <p class="hint">Files will save to your browser's Downloads folder.</p>
        </form>

        <p><a class="link" href="/">‚Üê Back to Home</a></p>
    </main>


    <script>
        const urlInput = document.getElementById("urlInput");
        const preview = document.getElementById("thumbnailPreview");

        urlInput.addEventListener("input", () => {
            const url = urlInput.value.trim();
            const videoId = extractYouTubeID(url);
            if (videoId) {
                const thumbURL = `https://img.youtube.com/vi/${videoId}/maxresdefault.jpg`;
                preview.innerHTML = `
          <img src="${thumbURL}" alt="Thumbnail" class="thumbnail-img" />
        `;
            } else {
                preview.innerHTML = "";
            }
        });

        function extractYouTubeID(url) {
            const regex =
                /(?:youtube\.com\/(?:[^\/\n\s]+\/\S+\/|(?:v|e(?:mbed)?)\/|\S*?[?&]v=)|youtu\.be\/)([a-zA-Z0-9_-]{11})/;
            const match = url.match(regex);
            return match ? match[1] : null;
        }
    </script>
</body>

</html>